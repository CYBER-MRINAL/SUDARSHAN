#!/bin/bash

module_08_malware() {
  echo ""
  echo " Malware Analysis"
  echo "1) YARA Scan"
  echo "2) CAPA Analysis"
  echo "3) FLOSS Strings Decode"
  echo "4) Binwalk Firmware Scan"
  echo "5) Back"
  echo ""
  read -p " (SUDARSHAN)> " opt

  case $opt in
    1) read -p "Rules File: " rules; read -p "Target File: " tgt; yara -r $rules $tgt | tee -a "$BASE_DIR/cases/$CURRENT_CASE/malware.txt";;
    2) read -p "Binary: " bin; capa $bin | tee -a "$BASE_DIR/cases/$CURRENT_CASE/malware.txt";;
    3) read -p "Binary: " bin; floss $bin | tee -a "$BASE_DIR/cases/$CURRENT_CASE/malware.txt";;
    4) read -p "Firmware: " fw; binwalk $fw | tee -a "$BASE_DIR/cases/$CURRENT_CASE/malware.txt";;
    5) return;;
    *) echo "Invalid";;
  esac
}

